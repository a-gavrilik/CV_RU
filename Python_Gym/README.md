# **Построение модели прогноза оттока клиентов и модели кластеризации клиентов на группы**

### Инструменты:
Python 
- Pandas
- Numpy
- Matplotlib
- Seaborn
- Sklearn
  - GridSearchCV
  - StandardScaler
  - LogisticRegression
  - QuadraticDiscriminantAnalysis
  - RandomForestClassifier
  - AdaBoostClassifier
  - GradientBoostingClassifier
  - KMeans

### Описание задачи:

Необходимо проанализировать DataFrame (gym.csv) с анонимными данными клиентов фитнес-центра и решить 2 задачи:
1. Построить модель, прогнозирующую отток клиентов в следующем месяце.
2. Построить модель кластеризации клиентов по группам.

### Описание полей DataFrame:

- **Churn** — факт оттока в текущем месяце;
- Данные клиента за предыдущий до проверки факта оттока месяц:
    - **Gender** — пол;
    - **Near_Location** — проживание или работа в районе, где находится фитнес-центр;
    - **Partner** — сотрудник компании-партнера клуба (сотрудничество с компаниями, чьи сотрудники могут получать скидки на абонемент — в таком случае фитнес-центр хранит информацию о работодателе клиента);
    - **Promo_friends** — факт первоначальной записи в рамках акции «приведи друга» (использовал промокод от знакомого при оплате первого абонемента);
    - **Phone** — наличие контактного телефона;
    - **Age** — возраст;
    - **Lifetime** — время с момента первого обращения в фитнес-центр (в месяцах).
- Информация на основе журнала посещений, покупок и информация о текущем статусе абонемента клиента:
    - **Contract_period** — длительность текущего действующего абонемента (месяц, 3 месяца, 6 месяцев, год);
    - **Month_to_end_contract** — срок до окончания текущего действующего абонемента (в месяцах);
    - **Group_visits** — факт посещения групповых занятий;
    - **Avg_class_frequency_total** — средняя частота посещений в неделю за все время с начала действия абонемента;
    - **Avg_class_frequency_current_month** — средняя частота посещений в неделю за предыдущий месяц;
    - **Avg_additional_charges_total** — суммарная выручка от других услуг фитнес-центра: кафе, спорт-товары, косметический и массажный салон.

### Описание решения:
Построил несколько моделей классификации для прогноза оттока клиентов в следующем месяце. Для этого:
- разделили выборку на тренировочную и тестовую с помощью train_test_split
- импортировал функционал выбранной модели
- обучил модель на тренировочной выборке методом fit
- сделал прогноз на тестовой выборке методом predict
- сравнил фактические данные и спрогнозированные и оценил точность модели по метрике f1_score

Апробировал несколько моделей из библиотеки Sklearn, а именно:
- LogisticRegression
- QuadraticDiscriminantAnalysis
- RandomForestClassifier
- AdaBoostClassifier
- GradientBoostingClassifier

Для каждой модели реализовал перебор параметров по сетке GridSearchCV. Для ускорения подбора оптимальных параметров перебирал не все, а только наиболее важные параметры. Затем оценил точность каждой модели по метрике f1_score и выбрал лучшую.

Далее построил модель кластеризации клиентов на группы по непрерывным признакам. Для реализации использовал метод KMeans. В результате все клиенты были разделены на 3 кластера.

Затем рассчитал процент оттока и средние значения непрерывных признаков в разрезе каждого кластера. В итоге получилось выявить кластер клиентов с наибольшим процентом оттока и средние значения непрерывных показателей клиентов, попавших в этот кластер.


